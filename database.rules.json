{
  "rules": {
    "tenants": {
      "$tenantId": {
        ".read": false,
        ".write": false,
        "members": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".write": false,
          "$memberUid": {
            ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true && (auth.uid === $memberUid || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')"
          }
        },
        "roles": {
          ".read": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".write": false,
          "$roleUid": {
            ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true && (auth.uid === $roleUid || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
            ".validate": "newData.isString() && (newData.val() === 'owner' || newData.val() === 'manager' || newData.val() === 'shift_manager' || newData.val() === 'viewer')"
          }
        },
        "audit": {
          ".read": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".write": false
        },
        "entries": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 16384"
        },
        "config": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 4096"
        },
        "suppliers": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 16384"
        },
        "fixed": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 8192"
        },
        "lastyear": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 32768"
        },
        "credits": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 8192"
        },
        "tasks": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true && root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() !== 'viewer'",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 16384"
        },
        "logs": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true && root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() !== 'viewer'",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 65536"
        },
        "active-log": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true && root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() !== 'viewer'",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 4096"
        },
        "pin": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
          ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 256"
        },
        "lookup": {
          ".read": true,
          ".write": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          "$username": {
            ".validate": "newData.hasChildren(['email','firebaseUid'])"
          }
        },
        "analytics": {
          ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
          ".write": false,
          "daily": {
            "$branchId": {
              "$date": {
                ".validate": "newData.hasChildren(['revenue_total','tickets','meta'])"
              }
            }
          },
          "_lock": {
            ".read": false,
            ".write": false
          }
        },
        "app": {
          ".read": false,
          ".write": false,
          "users": {
            ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
            ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
            ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 32768"
          },
          "business": {
            ".read": "auth !== null && root.child('tenants').child($tenantId).child('members').child(auth.uid).val() === true",
            ".write": "auth !== null && (root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'owner' || root.child('tenants').child($tenantId).child('roles').child(auth.uid).val() === 'manager')",
            ".validate": "newData.hasChildren(['_v']) && newData.child('_v').isString() && newData.child('_v').val().length < 8192"
          }
        }
      }
    },
    "app-users": {
      ".read": false,
      ".write": false
    },
    "app-businesses": {
      ".read": false,
      ".write": false
    },
    "users": {
      ".read": false,
      ".write": false
    },
    "shared": {
      ".read": false,
      ".write": false
    },
    "marjin": {
      ".read": false,
      ".write": false
    },
    "user_tenants": {
      "$uid": {
        ".read": "auth !== null && auth.uid === $uid",
        ".write": "auth !== null && auth.uid === $uid",
        ".validate": "newData.isString() && newData.val().length < 128"
      }
    },
    "user_active_biz": {
      "$uid": {
        ".read": "auth !== null && auth.uid === $uid",
        ".write": "auth !== null && auth.uid === $uid",
        ".validate": "newData.isString() && newData.val().length < 128"
      }
    },
    "$other": {
      ".read": false,
      ".write": false
    }
  }
}